<script>
AFRAME.registerComponent('ar-hit-test', {
  init: function () {
    const scene = this.el.sceneEl;
    const reticle = document.getElementById('reticle');

    // Make a container for all spawned objects
    let container = document.getElementById('placements');
    if (!container) {
      container = document.createElement('a-entity');
      container.id = 'placements';
      scene.appendChild(container); 
    }

    // Function to spawn a snowman or pine tree at a position
    function spawnAt(position) {
      // randomly pick one
      const choice = Math.random() < 0.5 ? 'prototype-snowman' : 'prototype-pinetree';
      const proto = document.getElementById(choice).cloneNode(true);
      proto.setAttribute('visible', 'true');

      const wrapper = document.createElement('a-entity');
      wrapper.setAttribute('position', `${position.x} ${position.y} ${position.z}`);
      wrapper.appendChild(proto);

      container.appendChild(wrapper);
    }

    // Add listener for taps
    scene.canvas.addEventListener('touchstart', () => {
      if (reticle && reticle.object3D.visible) {
        const pos = reticle.object3D.position.clone();
        spawnAt(pos);
      }
    });
  }
});
</script>
